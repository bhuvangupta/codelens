# CodeLens Backend Environment Configuration
# Copy this file to .env and fill in your values

# ===================
# Database Configuration
# ===================
DB_URL=jdbc:mysql://localhost:3306/codelens?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
DB_USERNAME=codelens
DB_PASSWORD=your-database-password
DB_ROOT_PASSWORD=your-root-password

# ===================
# LLM Providers
# ===================
# Default: ollama (runs locally, no API key needed)
# Options: ollama, claude, gemini, openai, glm
LLM_DEFAULT_PROVIDER=ollama

# --- Ollama (Recommended for self-hosted) ---
# Install: https://ollama.ai
# Pull model: ollama pull devstral-small
# No API key needed!
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=devstral-small

# --- Cloud Providers (Optional - set API key to enable) ---

# Anthropic Claude (https://console.anthropic.com/)
ANTHROPIC_API_KEY=

# Google Gemini (https://aistudio.google.com/)
GOOGLE_API_KEY=

# OpenAI (https://platform.openai.com/)
OPENAI_API_KEY=

# ZhipuAI GLM (https://open.bigmodel.cn/)
ZAI_API_KEY=

# ===================
# Git Providers
# ===================
# GitHub (https://github.com/settings/tokens)
GITHUB_TOKEN=your-github-personal-access-token
GITHUB_WEBHOOK_SECRET=your-github-webhook-secret

# GitLab (https://gitlab.com/-/profile/personal_access_tokens)
GITLAB_TOKEN=your-gitlab-personal-access-token
GITLAB_URL=https://gitlab.com
GITLAB_WEBHOOK_SECRET=your-gitlab-webhook-secret

# ===================
# OAuth Authentication
# ===================
# Default Google OAuth (https://console.cloud.google.com/apis/credentials)
# Use this for single-domain setup
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# --- Multi-Domain Google OAuth (Optional) ---
# For Google Workspace domains with separate OAuth apps
# Comma-separated list of domains (leave empty to use default GOOGLE_CLIENT_ID)
GOOGLE_OAUTH_DOMAINS=

# Domain to Organization mapping (JSON format)
# Example: {"domain1.com":"Org1","domain2.com":"Org2"}
DOMAIN_ORG_MAPPING={}

# Per-domain OAuth credentials
# Key format: GOOGLE_CLIENT_ID_<DOMAIN_KEY> where DOMAIN_KEY = domain with dots→underscores, uppercased
# Example: domain1.com → DOMAIN1_COM
# GOOGLE_CLIENT_ID_DOMAIN1_COM=xxx
# GOOGLE_CLIENT_SECRET_DOMAIN1_COM=xxx
# GOOGLE_CLIENT_ID_DOMAIN2_COM=xxx
# GOOGLE_CLIENT_SECRET_DOMAIN2_COM=xxx

# GitHub OAuth (https://github.com/settings/developers) - Optional
GITHUB_OAUTH_CLIENT_ID=
GITHUB_OAUTH_CLIENT_SECRET=
# Restrict GitHub login to members of this organization (leave empty to allow all)
GITHUB_REQUIRED_ORG=

# JWT Configuration
JWT_SECRET=your-256-bit-secret-key-change-in-production-must-be-at-least-32-chars

# OAuth2 Redirect URLs (adjust for production)
OAUTH2_CALLBACK_URL=http://localhost:5174/auth/callback/google
GITHUB_OAUTH_CALLBACK_URL=http://localhost:5174/auth/callback/github
OAUTH2_REDIRECT_URL=http://localhost:5174/auth/callback

# ===================
# Server Configuration
# ===================
SERVER_PORT=9292
SPRING_PROFILES_ACTIVE=dev

# Frontend URL (for generating review links in PR comments)
FRONTEND_URL=http://localhost:5174

# ===================
# Email / SMTP Configuration (Optional)
# ===================
# Set SMTP_ENABLED=true to enable email notifications
SMTP_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@codelens.dev
SMTP_FROM_NAME=CodeLens

# Base URL for email links (usually same as FRONTEND_URL)
CODELENS_BASE_URL=http://localhost:5174

# ===================
# CI/CD Integration
# ===================
# Generate with: openssl rand -hex 32
CI_API_KEY_1=your-secure-api-key-here
CI_API_KEY_2=

# ===================
# Deployment (optional)
# ===================
DOCKER_REGISTRY=
SERVER_HOST=
SERVER_USER=deploy
DEPLOY_DIR=/opt/codelens
